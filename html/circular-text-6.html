<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Circular Text Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
            flex-direction: row;
        }
        .container {
            display: flex;
            flex: 1;
        }
        .settings {
            width: 40%;
            padding: 20px;
            background-color: #f4f4f4;
            box-sizing: border-box;
        }
        .output {
            width: 60%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #fff;
            box-sizing: border-box;
        }
        .output canvas {
            background-color: lightgray;
        }
        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }
            .settings {
                width: 100%;
                height: 40%;
            }
            .output {
                width: 100%;
                height: 60%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="settings">
            <h3>Settings</h3>
            <textarea id="textInput" placeholder="Type your text here..." rows="3" style="width: 100%;">ROUNDED TEXT LOOKS BEST IN CAPS!</textarea>
            <label for="fontName">Font Name: </label>
            <input type="text" id="fontName" value="Arial">
            <br><br>
            <label for="fontSize">Font Size: </label>
            <input type="text" id="fontSize" value="18pt">
            <br><br>
            <label for="diameter">Circle Diameter: </label>
            <input type="number" id="diameter" value="250">
            <br><br>
            <label for="startAngle">Start Angle (degrees): </label>
            <input type="number" id="startAngle" value="0" min="0" max="360">
            <br><br>
            <label for="align">Text Align: </label>
            <select id="align">
                <option value="center">Center</option>
                <option value="left">Left</option>
                <option value="right">Right</option>
            </select>
            <br><br>
            <label for="textInside">Text Inside Circle: </label>
            <input type="checkbox" id="textInside" checked>
            <br><br>
            <label for="inwardFacing">Inward Facing: </label>
            <input type="checkbox" id="inwardFacing" checked>
            <br><br>
            <label for="kerning">Kerning: </label>
            <input type="number" id="kerning" value="2">
            <br><br>
            <label for="textColor">Text Color: </label>
            <input type="color" id="textColor" value="#000000">
            <br><br>
            <label for="bgColor">Canvas Background Color: </label>
            <input type="color" id="bgColor" value="#d3d3d3"> <!-- Default to lightgray -->
        </div>
        <div class="output" id="output">
            <!-- Circular text will be drawn here -->
        </div>
    </div>

    <script>
        function updateOutput() {
            const text = document.getElementById('textInput').value;
            const diameter = parseInt(document.getElementById('diameter').value);
            const startAngle = parseInt(document.getElementById('startAngle').value);
            const align = document.getElementById('align').value;
            const textInside = document.getElementById('textInside').checked;
            const inwardFacing = document.getElementById('inwardFacing').checked;
            const fontName = document.getElementById('fontName').value;
            const fontSize = document.getElementById('fontSize').value;
            const kerning = parseInt(document.getElementById('kerning').value);
            const textColor = document.getElementById('textColor').value;
            const bgColor = document.getElementById('bgColor').value;

            const output = document.getElementById('output');
            output.innerHTML = ''; // Clear previous content

            const canvas = getCircularText(text, diameter, startAngle, align, textInside, inwardFacing, fontName, fontSize, kerning, textColor, bgColor);
            output.appendChild(canvas);
        }

        // Initial render
        updateOutput();

        // Add event listeners for real-time updates
        document.getElementById('textInput').addEventListener('input', updateOutput);
        document.getElementById('fontName').addEventListener('input', updateOutput);
        document.getElementById('fontSize').addEventListener('input', updateOutput);
        document.getElementById('diameter').addEventListener('input', updateOutput);
        document.getElementById('startAngle').addEventListener('input', updateOutput);
        document.getElementById('align').addEventListener('change', updateOutput);
        document.getElementById('textInside').addEventListener('change', updateOutput);
        document.getElementById('inwardFacing').addEventListener('change', updateOutput);
        document.getElementById('kerning').addEventListener('input', updateOutput);
        document.getElementById('textColor').addEventListener('input', updateOutput);
        document.getElementById('bgColor').addEventListener('input', updateOutput);

        function getCircularText(text, diameter, startAngle, align, textInside, inwardFacing, fName, fSize, kerning, textColor, bgColor) {
            // text:         The text to be displayed in circular fashion
            // diameter:     The diameter of the circle around which the text will
            //               be displayed (inside or outside)
            // startAngle:   In degrees, Where the text will be shown. 0 degrees
            //               if the top of the circle
            // align:        Positions text to left right or center of startAngle
            // textInside:   true to show inside the diameter. False to show outside
            // inwardFacing: true for base of text facing inward. false for outward
            // fName:        name of font family. Make sure it is loaded
            // fSize:        size of font family. Don't forget to include units
            // kerning:      0 for normal gap between letters. positive or
            //               negative number to expand/compact gap in pixels
            // textColor:    Color of the text
            // bgColor:      Background color of the canvas

            // declare and intialize canvas, reference, and useful variables
            align = align.toLowerCase();
            var mainCanvas = document.createElement('canvas');
            var ctxRef = mainCanvas.getContext('2d');
            var clockwise = align == "right" ? 1 : -1; // draw clockwise for aligned right. Else Anticlockwise
            startAngle = startAngle * (Math.PI / 180); // convert to radians

            // calculate height of the font. Many ways to do this
            // you can replace with your own!
            var div = document.createElement("div");
            div.innerHTML = text;
            div.style.position = 'absolute';
            div.style.top = '-10000px';
            div.style.left = '-10000px';
            div.style.fontFamily = fName;
            div.style.fontSize = fSize;
            document.body.appendChild(div);
            var textHeight = div.offsetHeight;
            document.body.removeChild(div);

            // in cases where we are drawing outside diameter,
            // expand diameter to handle it
            if (!textInside) diameter += textHeight * 2;

            mainCanvas.width = diameter;
            mainCanvas.height = diameter;
            ctxRef.fillStyle = textColor;
            ctxRef.font = fSize + ' ' + fName;
            ctxRef.fillStyle = textColor;
            ctxRef.fillRect(0, 0, mainCanvas.width, mainCanvas.height);
            ctxRef.fillStyle = bgColor;
            ctxRef.fillRect(0, 0, mainCanvas.width, mainCanvas.height);
            ctxRef.fillStyle = textColor;

            // Reverse letters for align Left inward, align right outward 
            // and align center inward.
            if (((["left", "center"].indexOf(align) > -1) && inwardFacing) || (align == "right" && !inwardFacing)) text = text.split("").reverse().join(""); 

            // Setup letters and positioning
            ctxRef.translate(diameter / 2, diameter / 2); // Move to center
            startAngle += (Math.PI * !inwardFacing); // Rotate 180 if outward
            ctxRef.textBaseline = 'middle'; // Ensure we draw in exact center
            ctxRef.textAlign = 'center'; // Ensure we draw in exact center

            // rotate 50% of total angle for center alignment
            if (align == "center") {
                for (var j = 0; j < text.length; j++) {
                    var charWid = ctxRef.measureText(text[j]).width;
                    startAngle += ((charWid + (j == text.length-1 ? 0 : kerning)) / (diameter / 2 - textHeight)) / 2 * -clockwise;
                }
            }

            // Phew... now rotate into final start position
            ctxRef.rotate(startAngle);

            // Now for the fun bit: draw, rotate, and repeat
            for (var j = 0; j < text.length; j++) {
                var charWid = ctxRef.measureText(text[j]).width; // half letter
                // rotate half letter
                ctxRef.rotate((charWid/2) / (diameter / 2 - textHeight) * clockwise); 
                // draw the character at "top" or "bottom" 
                // depending on inward or outward facing
                ctxRef.fillText(text[j], 0, (inwardFacing ? 1 : -1) * (0 - diameter / 2 + textHeight / 2));

                ctxRef.rotate((charWid/2 + kerning) / (diameter / 2 - textHeight) * clockwise); // rotate half letter
            }

            // Return it
            return (mainCanvas);
        }
    </script>
</body>
</html>
