#!/bin/bash
# Trigger a cherry-pick of the specified customization in the current or
# specified branch

## Imports #####################################################################
################################################################################

include-source 'echo.sh'
include-source 'git.sh'
include-source 'opg-as-common.sh'


## Usage functions #############################################################
################################################################################

function help-usage() {
    echo "usage: $(basename $0) [-hb] customization"
}


## Main ########################################################################
################################################################################

function main() {
    # Determine if this is an OPG repo or the Trinoor repo
    if [ -d "$(git-root)/devops" ]; then
        repo_type='opg'
    else
        repo_type='trinoor'
    fi

    if [ "${repo_type}" = "opg" ]; then
        trigger-cherry-pick-opg "${@}"
    elif [ "${repo_type}" = "trinoor" ]; then
        trigger-cherry-pick-trinoor "${@}"
    else
        echo "Unknown repo type: $(git-root): ${repo_type}" >&2
        exit 1
    fi
}


## Run #########################################################################
################################################################################

[ "${BASH_SOURCE[0]}" == "${0}" ] && main "$@"
